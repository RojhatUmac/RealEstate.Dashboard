@page "/houses/{id:int}"
@inject HouseState HouseState
@inject NavigationManager Navigation
@using MudBlazor
@using RealEstate.Dashboard.Models

@if (house is null)
{
    <MudText>Yükleniyor...</MudText>
}
else
{
    <MudContainer MaxWidth="MaxWidth.False" Class="mt-6">

        <MudPaper Elevation="3"
                  Class="pa-4 mx-auto"
                  Style="max-width:1200px;">

            <!-- BAŞLIK -->
            <MudText Typo="Typo.h4" Align="Align.Center">
                @house.Title
            </MudText>

            <MudText Typo="Typo.subtitle1"
                     Align="Align.Center"
                     Color="Color.Secondary"
                     Class="mb-4">
                @house.City • @house.Price ₺
            </MudText>

            <!-- GÖRSEL GALERİ -->
            @if (house.Images is not null && house.Images.Any())
            {
                <MudCarousel TData="string"
                             ShowArrows="true"
                             ShowBullets="true"
                             AutoCycle="false"
                             Style="width:100%; height:520px;">

                    @foreach (var img in house.Images)
                    {
                        <MudCarouselItem TData="string" Item="@img">
                            <MudImage Src="@img"
                                      Style="width:100%; height:520px; object-fit:cover;" />
                        </MudCarouselItem>
                    }

                </MudCarousel>
            }

            <!-- AÇIKLAMA -->
            @if (!string.IsNullOrWhiteSpace(house.Description))
            {
                <MudText Typo="Typo.body1" Class="mt-4">
                    @((MarkupString)house.Description)
                </MudText>
            }
            else
            {
                <MudText Typo="Typo.body2" Color="Color.Secondary" Class="mt-4">
                    Bu ilan için açıklama girilmemiş.
                </MudText>
            }

        </MudPaper>

    </MudContainer>
}

@code {

    [Parameter]
    public int Id { get; set; }

    House? house;

    protected override void OnInitialized()
    {
        house = HouseState.Houses.FirstOrDefault(x => x.Id == Id);

        if (house is null)
            Navigation.NavigateTo("/houses");
    }
}