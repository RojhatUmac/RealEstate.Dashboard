@using MudBlazor
@using RealEstate.Dashboard.Data
@inherits LayoutComponentBase
@inject ThemeState ThemeState
@inject AuthState Auth
@inject NavigationManager Navigation

<MudThemeProvider Theme="@AppTheme"
                  IsDarkMode="@ThemeState.IsDarkMode" />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>

    <!-- ÜST BAR -->
    <MudAppBar Elevation="1">
        <MudText Typo="Typo.h6">Real Estate Dashboard</MudText>
    </MudAppBar>

    <!-- SOL MENÜ -->
    <MudDrawer Open="true" Variant="DrawerVariant.Responsive" Elevation="1">
        <MudNavMenu>
            <MudNavLink Href="/dashboard"
                        Match="NavLinkMatch.All"
                        Icon="@Icons.Material.Filled.Dashboard">
                Dashboard
            </MudNavLink>

            <MudNavLink Href="/"
                        Match="NavLinkMatch.All"
                        Icon="@Icons.Material.Filled.Home">
                Anasayfa
            </MudNavLink>

            <MudNavLink Href="/houses"
                        Icon="@Icons.Material.Filled.House">
                Evlerim
            </MudNavLink>

            <MudNavLink Href="/settings"
                        Icon="@Icons.Material.Filled.Settings">
                Ayarlar
            </MudNavLink>
            <MudNavLink Icon="@Icons.Material.Filled.Logout"
                        OnClick="HandleLogout">
                Çıkış
            </MudNavLink>

        </MudNavMenu>
    </MudDrawer>

    <!-- SAYFA -->
    <MudMainContent>
        @Body
    </MudMainContent>

</MudLayout>

@code {

    MudTheme AppTheme => new MudTheme
    {
        PaletteLight = new PaletteLight
        {
            Primary = Colors.Blue.Default
        },
        PaletteDark = new PaletteDark
        {
            Primary = Colors.Blue.Lighten1
        }
    };

    protected override void OnInitialized()
    {
        ThemeState.OnChange += StateHasChanged;
    }

    public void Dispose()
    {
        ThemeState.OnChange -= StateHasChanged;
        
    }
    public void HandleLogout()
    {
        Auth.Logout();
        Navigation.NavigateTo("/login", true);
    }
}
